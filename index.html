<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Programmatic Interface to OpenM++ • openmpp</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Programmatic Interface to OpenM++">
<meta name="description" content="A programmatic interface to the OpenM++ microsimulation platform. The primary goal of this package is to wrap the OpenM++ Web Service (OMS) to provide existing OpenM++ users a programmatic interface for the R language.">
<meta property="og:description" content="A programmatic interface to the OpenM++ microsimulation platform. The primary goal of this package is to wrap the OpenM++ Web Service (OMS) to provide existing OpenM++ users a programmatic interface for the R language.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">openmpp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mattwarkentin/openmpp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="openmpp">openmpp<a class="anchor" aria-label="anchor" href="#openmpp"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of <code>openmpp</code> is to provide a programmatic interface to the OpenM++ API directly from R to simplify creating scenarios, running models, and gathering results for further processing.</p>
<div class="section level2">
<h2 id="installation-r-package">Installation (R Package)<a class="anchor" aria-label="anchor" href="#installation-r-package"></a>
</h2>
<p>You can install the development version of <code>openmpp</code> from <a href="https://github.com/mattwarkentin/openmpp" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mattwarkentin/openmpp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation-openm">Installation (OpenM++)<a class="anchor" aria-label="anchor" href="#installation-openm"></a>
</h2>
<p>If you do not have access to an existing OpenM++ server, you can download and install OpenM++ locally and run a local server on your workstation. The <code>openmpp</code> package can then connect to this local server instance.</p>
<div class="section level3">
<h3 id="download">Download<a class="anchor" aria-label="anchor" href="#download"></a>
</h3>
<p>For most users, the best way to install OpenM++ locally is to download the pre-compiled binaries. To install OpenM++, download and unzip the “Source code and binaries” appropriate for your operating system. The latest release of OpenM++ can be found here: <a href="https://github.com/openmpp/main/releases/latest" class="external-link uri">https://github.com/openmpp/main/releases/latest</a>. Pre-compiled binaries are available for Mac (Intel and Arm), Windows, and several common Linux distributions (Debian, Ubuntu, RedHat).</p>
<p>NOTE: Windows may allow you to view the contents of the zip directory without extracting, however, the files must be extracted for the installation to function properly.</p>
</div>
<div class="section level3">
<h3 id="running-openm-on-windows">Running OpenM++ on Windows<a class="anchor" aria-label="anchor" href="#running-openm-on-windows"></a>
</h3>
<p>Enter the OpenM++ directory using the File Explorer. Right-click anywhere inside the folder and select “Open in Terminal”.</p>
<p>In the Windows Terminal, enter the following command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>.\bin\oms.exe</span></code></pre></div>
<p>This will start the process responsible for running the OpenM++ web service (OMS). Note that the local host address (e.g., <a href="http://localhost:4040" class="external-link uri">http://localhost:4040</a>) will be printed in the console and is the address used by the <code>openmpp</code> R package to communicate with the API. This local host address will be set as the <code>OPENMPP_LOCAL_URL</code>. See the Usage section for more details.</p>
</div>
<div class="section level3">
<h3 id="running-openm-on-macos">Running OpenM++ on MacOS<a class="anchor" aria-label="anchor" href="#running-openm-on-macos"></a>
</h3>
<p>Open a new MacOS Terminal window (either by using Spotlight Search or by navigating to “Applications” and then “Utilities” in Finder).</p>
<p>After unzipping the downloaded directory in Finder, drag the folder into the terminal and press Enter. This will change your active directory to the OpenM++ folder.</p>
<p>Enter the following command into the terminal:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">bin/oms</span></span></code></pre></div>
<p>Similar to the Windows installation, the web service (OMS) will initiate and the local host address will be shared with the R package for API communication.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The <code>openmpp</code> package contains many functions that provide access to nearly every OpenM++ API endpoint. However, users of this package will typically only use a smaller set of functions for most common tasks.</p>
<div class="section level3">
<h3 id="user-authentication">User Authentication<a class="anchor" aria-label="anchor" href="#user-authentication"></a>
</h3>
<p>Each user is required to set their local or remote host address (i.e., URL) for the OpenM++ API in their global or project-specific <code>.Renviron</code> file in order for the <code>openmpp</code> package to authenticate and communicate with the API on behalf of the user.</p>
<p>If you are working in an IDE (e.g., Positron, RStudio), you may consider using the following function <code>usethis::edit_r_environ()</code> to open your <code>.Renviron</code> file for editing. Note that you will need to restart your R session after editing the file for the effect to take place.</p>
<p>For an API running locally, set the following environment variable in your <code>.Renviron</code> file:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>OPENMPP_LOCAL_URL<span class="ot">=</span>http<span class="sc">:</span><span class="er">//</span>localhost<span class="sc">:</span>XXXX</span></code></pre></div>
<p>Where <code>XXXX</code> is the four digits corresponding to your specific local host address (typically 4040 is used). The local host address is printed to the console when starting the OpenM++ web service in the terminal.</p>
<p>This package also provides the ability to remotely connect to OpenM++ using JWT tokens. For an API running remotely, set the following environment variables in your <code>.Renviron</code> file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>OPENMPP_REMOTE_URL<span class="ot">=</span>...</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>OPENMPP_REMOTE_USER<span class="ot">=</span>...</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>OPENMPP_REMOTE_PWD<span class="ot">=</span>...</span></code></pre></div>
<p>If you aren’t sure of your remote URL or your username/password, you may contact your OpenM++ administrator to retrieve this information. Note that the URL, user name, and password should be kept confidential and not committed into version control (e.g., git).</p>
<p>Once the environment variables are set, users may register a local or remote API connection in their R scripts.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattwarkentin/openmpp" class="external-link">openmpp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/use_OpenMpp_local.html">use_OpenMpp_local</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Or,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattwarkentin/openmpp" class="external-link">openmpp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/use_OpenMpp_local.html">use_OpenMpp_remote</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>see <code><a href="reference/use_OpenMpp_local.html">?use_OpenMpp_local</a></code> or <code><a href="reference/use_OpenMpp_local.html">?use_OpenMpp_remote</a></code> for more information.</p>
</div>
<div class="section level3">
<h3 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h3>
<ul>
<li>
<p>Functions for accessing tables of models, worksets, or model runs</p>
<ul>
<li><p><code><a href="reference/get_model.html">get_models()</a></code></p></li>
<li><p><code><a href="reference/get_workset.html">get_worksets()</a></code> / <code><a href="reference/get_workset.html">get_scenarios()</a></code></p></li>
<li><p><code><a href="reference/get_model_run.html">get_model_runs()</a></code> / <code><a href="reference/get_model_run.html">get_runs()</a></code></p></li>
</ul>
</li>
<li>
<p>Functions for creating new worksets or scenarios</p>
<ul>
<li>
<code><a href="reference/create_scenario.html">create_scenario()</a></code> / <code><a href="reference/set_workset_readonly.html">create_workset()</a></code>
</li>
</ul>
</li>
<li>
<p>Functions for loading models, worksets, or model runs</p>
<ul>
<li><p><code><a href="reference/load_model.html">load_model()</a></code></p></li>
<li><p><code><a href="reference/load_workset.html">load_workset()</a></code> / <code><a href="reference/load_workset.html">load_scenario()</a></code></p></li>
<li><p><code><a href="reference/load_model_run.html">load_model_run()</a></code> / <code><a href="reference/load_model_run.html">load_run()</a></code></p></li>
<li><p><code><a href="reference/load_model_runs.html">load_model_runs()</a></code> / <code><a href="reference/load_model_runs.html">load_runs()</a></code></p></li>
</ul>
</li>
<li>
<p>Functions for deleting worksets or model runs</p>
<ul>
<li><p><code><a href="reference/set_workset_readonly.html">delete_workset()</a></code> / <code><a href="reference/set_workset_readonly.html">delete_scenario()</a></code></p></li>
<li><p><code><a href="reference/delete_model_run.html">delete_model_run()</a></code> / <code><a href="reference/delete_model_run.html">delete_run()</a></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="models-scenarios-runs-and-runsets">Models, Scenarios, Runs, and RunSets<a class="anchor" aria-label="anchor" href="#models-scenarios-runs-and-runsets"></a>
</h3>
<p>There are 4 main classes you will work with when using the <code>openmpp</code> package: <code>OpenMppModel</code>, <code>OpenMppWorkset</code>, <code>OpenMppModelRun</code>, and <code>OpenMppModelRunSet</code>. Each of these are <code>R6</code> classes. <code>R6</code> is an encapsulated object-oriented programming system for R. Use the <code>load_*()</code> set of functions to load a model, workset/scenario, model run, or set of model runs into memory.</p>
<p>Instances of each of these 4 classes have methods and fields associated with them. You can access public methods and fields using the standard <code>$</code> subset operator (e.g., <code>obj$action()</code> or <code>obj$field</code>)</p>
</div>
<div class="section level3">
<h3 id="developing-new-models">Developing New Models<a class="anchor" aria-label="anchor" href="#developing-new-models"></a>
</h3>
<p>Developing new microsimulation or agent-based models in OpenM++ is beyond the scope of this package. In-depth information on model development can be found here: <a href="https://github.com/openmpp/openmpp.github.io/wiki/Model-Development-Topics" class="external-link uri">https://github.com/openmpp/openmpp.github.io/wiki/Model-Development-Topics</a>.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Next, we will work through a very simple example of creating a new scenario, extracting parameters to change, changing parameters, running the model, and extracting results. This example will use the <strong>RiskPaths</strong> model that comes with the OpenM++ software. RiskPaths is a simple, competing risk, case-based continuous time miscrosimulation model (<a href="https://www.statcan.gc.ca/en/microsimulation/modgen/new/chap3/chap3-2" class="external-link">More Information</a>).</p>
<p>To run this example, you must have installed OpenM++, initiated the OpenM++ web service (OMS) in the shell, and configured the R package using the instructions above.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattwarkentin/openmpp" class="external-link">openmpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/use_OpenMpp_local.html">use_OpenMpp_local</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Let’s see what models are available:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_model.html">get_models</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 7</span></span>
<span><span class="co">#&gt;   ModelId Name               Digest  Type Version CreateDateTime DefaultLangCode</span></span>
<span><span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1     101 IDMM               bd573…     1 2.0.0.0 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 2     101 NewCaseBased       be317…     0 1.0.0.0 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 3     101 NewCaseBased_bili… 2a78a…     0 1.0.0.0 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 4     101 NewTimeBased       49cec…     1 1.0.1.0 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 5     101 OzProjGenX         1da1c…     0 0.22.0… 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 6     101 OzProjX            2e697…     0 0.22.0… 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 7     101 RiskPaths          d976a…     0 3.0.0.0 2024-12-26 07… EN             </span></span>
<span><span class="co">#&gt; 8       1 modelOne           _2012…     0 1.0     2012-08-17 16… EN</span></span></code></pre></div>
<p>We can now see what worksets and model runs exist for a given model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_workset.html">get_worksets</a></span><span class="op">(</span><span class="st">'RiskPaths'</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 10</span></span>
<span><span class="co">#&gt;   ModelName ModelDigest     ModelVersion ModelCreateDateTime Name  BaseRunDigest</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt; &lt;chr&gt;        </span></span>
<span><span class="co">#&gt; 1 RiskPaths d976aa2fb999f0… 3.0.0.0      2024-12-26 07:24:5… Defa… ""           </span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: IsReadonly &lt;lgl&gt;, UpdateDateTime &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   IsCleanBaseRun &lt;lgl&gt;, Txt &lt;list&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_model_run.html">get_runs</a></span><span class="op">(</span><span class="st">'RiskPaths'</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 15</span></span>
<span><span class="co">#&gt;   ModelName ModelDigest          ModelVersion ModelCreateDateTime Name  SubCount</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 RiskPaths d976aa2fb999f097468… 3.0.0.0      2024-12-26 07:24:5… Risk…        1</span></span>
<span><span class="co">#&gt; # ℹ 9 more variables: SubStarted &lt;int&gt;, SubCompleted &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   CreateDateTime &lt;chr&gt;, Status &lt;chr&gt;, UpdateDateTime &lt;chr&gt;, RunId &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   RunDigest &lt;chr&gt;, ValueDigest &lt;chr&gt;, RunStamp &lt;chr&gt;</span></span></code></pre></div>
<p>Now we can load the <code>RiskPaths</code> model to inspect.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_model.html">load_model</a></span><span class="op">(</span><span class="st">'RiskPaths'</span><span class="op">)</span></span>
<span><span class="va">rp</span></span>
<span><span class="co">#&gt; ── OpenM++ Model ───────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; → ModelName: RiskPaths</span></span>
<span><span class="co">#&gt; → ModelVersion: 3.0.0.0</span></span>
<span><span class="co">#&gt; → ModelDigest: d976aa2fb999f097468bb2ea098c4daf</span></span></code></pre></div>
<p>We will now load the <code>Default</code> set of input parameters for the RiskPaths model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rp_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_workset.html">load_scenario</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="st">'Default'</span><span class="op">)</span></span>
<span><span class="va">rp_default</span></span>
<span><span class="co">#&gt; ── OpenM++ Workset (ReadOnly) ──────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; → ModelName: RiskPaths</span></span>
<span><span class="co">#&gt; → ModelVersion: 3.0.0.0</span></span>
<span><span class="co">#&gt; → ModelDigest: d976aa2fb999f097468bb2ea098c4daf</span></span>
<span><span class="co">#&gt; → WorksetName: Default</span></span>
<span><span class="co">#&gt; → BaseRunDigest:</span></span></code></pre></div>
<p>Finally, we will load the base run for the RiskPaths model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baserun_digest</span> <span class="op">&lt;-</span> <span class="va">rp</span><span class="op">$</span><span class="va">ModelRuns</span><span class="op">$</span><span class="va">RunDigest</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">rp_baserun</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_model_run.html">load_run</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="va">baserun_digest</span><span class="op">)</span></span>
<span><span class="va">rp_baserun</span></span>
<span><span class="co">#&gt; ── OpenM++ ModelRun ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; → ModelName: RiskPaths</span></span>
<span><span class="co">#&gt; → ModelVersion: 3.0.0.0</span></span>
<span><span class="co">#&gt; → ModelDigest: d976aa2fb999f097468bb2ea098c4daf</span></span>
<span><span class="co">#&gt; → RunName: RiskPaths_Default</span></span>
<span><span class="co">#&gt; → RunDigest: c02d49bfda2e2ff05262ac0f0e30d830</span></span></code></pre></div>
<p>We will create a new scenario based on the parameters from the <code>RiskPaths_Default</code> model run.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/create_scenario.html">create_scenario</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="st">'MyNewScenario'</span>, <span class="va">baserun_digest</span><span class="op">)</span></span></code></pre></div>
<p>We will load the new scenario, copy over the <code>AgeBaselinePreg1</code> parameter from the base run.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_workset.html">load_scenario</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="st">'MyNewScenario'</span><span class="op">)</span></span></code></pre></div>
<p>Let’s reduce the fertility rate by 10% across all age groups…</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_scenario</span><span class="op">$</span><span class="fu">copy_params</span><span class="op">(</span><span class="st">'AgeBaselinePreg1'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">current_rates</span> <span class="op">&lt;-</span> <span class="va">my_scenario</span><span class="op">$</span><span class="va">Parameters</span><span class="op">$</span><span class="va">AgeBaselinePreg1</span></span>
<span></span>
<span><span class="va">reduced_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">current_rates</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">sub_id</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_scenario</span><span class="op">$</span><span class="va">Parameters</span><span class="op">$</span><span class="va">AgeBaselinePreg1</span> <span class="op">&lt;-</span> <span class="va">reduced_rates</span></span></code></pre></div>
<p>We will now run the model and give it the name <code>'ExampleRun'</code>. We use the <code>wait = TRUE</code> flag to make sure we want for the model run to finish before returning to our R session. We use <code>progress = FALSE</code> to avoid printing progress bars in this document. Note that model runs may take a long time when the number of simulation cases is large.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_scenario</span><span class="op">$</span><span class="va">ReadOnly</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">my_scenario</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">'ExampleRun'</span>, wait <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that we can use the <code>opts</code> argument and the <code><a href="reference/opts_run.html">opts_run()</a></code> function to configure our run. By default, models are run with 5,000 simulation cases and 12 SubValues. This allows for quick model runs and faster iteration, but users will want to increase the number of simulation cases when performing a full model run.</p>
<p>Now that our model run is complete, let’s load it into memory.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_run</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_model_run.html">load_run</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="st">'ExampleRun'</span><span class="op">)</span></span>
<span><span class="va">example_run</span></span>
<span><span class="co">#&gt; ── OpenM++ ModelRun ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; → ModelName: RiskPaths</span></span>
<span><span class="co">#&gt; → ModelVersion: 3.0.0.0</span></span>
<span><span class="co">#&gt; → ModelDigest: d976aa2fb999f097468bb2ea098c4daf</span></span>
<span><span class="co">#&gt; → RunName: ExampleRun</span></span>
<span><span class="co">#&gt; → RunDigest: 75414f902f6c7d20018ae857833b33fa</span></span></code></pre></div>
<p>We can now extract an output table from the <code>Tables</code> field in the model run object (<code>example_run$Tables</code>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_run</span><span class="op">$</span><span class="va">Tables</span><span class="op">$</span><span class="va">T06_BirthsByUnion</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 3</span></span>
<span><span class="co">#&gt;   expr_name Dim0                   expr_value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Expr0     US_NEVER_IN_UNION         1205.  </span></span>
<span><span class="co">#&gt; 2 Expr0     US_FIRST_UNION_PERIOD1    2944.  </span></span>
<span><span class="co">#&gt; 3 Expr0     US_FIRST_UNION_PERIOD2     333.  </span></span>
<span><span class="co">#&gt; 4 Expr0     US_AFTER_FIRST_UNION        10.0 </span></span>
<span><span class="co">#&gt; 5 Expr0     US_SECOND_UNION             72.0 </span></span>
<span><span class="co">#&gt; 6 Expr0     US_AFTER_SECOND_UNION        1.00</span></span>
<span><span class="co">#&gt; 7 Expr0     all                       4565.</span></span></code></pre></div>
<p>Great, we have created a new scenario, modified some parameters, ran the model, and extracted output tables. In this last step, we will load multiple model runs into memory to compare them.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rp_runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_model_runs.html">load_runs</a></span><span class="op">(</span><span class="st">'RiskPaths'</span>, <span class="va">rp</span><span class="op">$</span><span class="va">ModelRuns</span><span class="op">$</span><span class="va">RunDigest</span><span class="op">)</span></span>
<span><span class="va">rp_runs</span></span>
<span><span class="co">#&gt; ── OpenM++ ModelRunSet ─────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; → ModelName: RiskPaths</span></span>
<span><span class="co">#&gt; → ModelVersion: 3.0.0.0</span></span>
<span><span class="co">#&gt; → ModelDigest: d976aa2fb999f097468bb2ea098c4daf</span></span>
<span><span class="co">#&gt; → RunNames: [RiskPaths_Default, ExampleRun]</span></span>
<span><span class="co">#&gt; → RunDigests: [c02d49bfda2e2ff05262ac0f0e30d830, 75414f902f6c7d20018ae857833b33fa]</span></span></code></pre></div>
<p>We will extract a new table from both models. Note that an extra column, <code>RunName</code> is added to indicate which model run the output table data corresponds to.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">births</span> <span class="op">&lt;-</span> <span class="va">rp_runs</span><span class="op">$</span><span class="va">Tables</span><span class="op">$</span><span class="va">T06_BirthsByUnion</span></span>
<span><span class="va">births</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 4</span></span>
<span><span class="co">#&gt;    RunName           expr_name Dim0                   expr_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;chr&gt;     &lt;chr&gt;                       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 RiskPaths_Default Expr0     US_NEVER_IN_UNION         1285   </span></span>
<span><span class="co">#&gt;  2 RiskPaths_Default Expr0     US_FIRST_UNION_PERIOD1    2986   </span></span>
<span><span class="co">#&gt;  3 RiskPaths_Default Expr0     US_FIRST_UNION_PERIOD2     293   </span></span>
<span><span class="co">#&gt;  4 RiskPaths_Default Expr0     US_AFTER_FIRST_UNION        11   </span></span>
<span><span class="co">#&gt;  5 RiskPaths_Default Expr0     US_SECOND_UNION             57   </span></span>
<span><span class="co">#&gt;  6 RiskPaths_Default Expr0     US_AFTER_SECOND_UNION        1   </span></span>
<span><span class="co">#&gt;  7 RiskPaths_Default Expr0     all                       4633   </span></span>
<span><span class="co">#&gt;  8 ExampleRun        Expr0     US_NEVER_IN_UNION         1205.  </span></span>
<span><span class="co">#&gt;  9 ExampleRun        Expr0     US_FIRST_UNION_PERIOD1    2944.  </span></span>
<span><span class="co">#&gt; 10 ExampleRun        Expr0     US_FIRST_UNION_PERIOD2     333.  </span></span>
<span><span class="co">#&gt; 11 ExampleRun        Expr0     US_AFTER_FIRST_UNION        10.0 </span></span>
<span><span class="co">#&gt; 12 ExampleRun        Expr0     US_SECOND_UNION             72.0 </span></span>
<span><span class="co">#&gt; 13 ExampleRun        Expr0     US_AFTER_SECOND_UNION        1.00</span></span>
<span><span class="co">#&gt; 14 ExampleRun        Expr0     all                       4565.</span></span></code></pre></div>
<p>We can even plot this using <code>ggplot2</code>! Note that the number of simulation cases for <code>ExampleRun</code> is <strong>low</strong> so the results are not to be trusted! This is only for demonstration purposes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">births</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">Dim0</span>, <span class="va">expr_value</span>, fill <span class="op">=</span> <span class="va">RunName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">'Number of births by union'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
<p>When we are sure we no longer need a scenario or model run, we can use <code><a href="reference/set_workset_readonly.html">delete_scenario()</a></code> or <code><a href="reference/delete_model_run.html">delete_run()</a></code> to clean things up!</p>
</div>
</div>
<div class="section level2">
<h2 id="contributor-guidelines">Contributor Guidelines<a class="anchor" aria-label="anchor" href="#contributor-guidelines"></a>
</h2>
<p>Contributions to this package are welcome. The preferred method of contribution is through a GitHub pull request. Before contributing, please file an issue to discuss the idea with the project team. More details on contributing can be found in the <a href="https://github.com/mattwarkentin/openmpp/blob/main/CONTRIBUTING.md" class="external-link">CONTRIBUTING</a> document.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>openmpp</code> project is released with a <a href="https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mattwarkentin/openmpp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mattwarkentin/openmpp/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing openmpp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matthew T. Warkentin <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8730-3511" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/mattwarkentin/openmpp/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/mattwarkentin/openmpp/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew T. Warkentin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
